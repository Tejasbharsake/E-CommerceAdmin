@model List<GSTECommerceLibrary.Admin.Admin>

@{
    ViewBag.Title = "AddOffer";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


@section Breadcrumb {
    <li class="breadcrumb-item active" aria-current="page">
        <span style="color: #6c757d;">Notification </span> <strong> / Request For Offer</strong>
    </li>

}

<head>
    <link href="~/Content/Document/custom-datatables/custom-datatables.css" rel="stylesheet" />
    <!-- DataTables Buttons CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.2.3/css/buttons.bootstrap5.min.css">
    <!-- DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/dataTables.bootstrap5.min.css">
    <!-- DateRangePicker CSS -->
    <!--<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/daterangepicker@3.1/daterangepicker.css" />-->

    <link href="~/Content/Document/CSS/AddOfferSC.css" rel="stylesheet" />


</head>

<!--<section class="section">
    <div class="card">-->
@*<div class="card-header">
        <h5 class="mb-0">Request For Offer</h5>
    </div>*@

<!--<div class="card-body">
    <div class="row mb-3">-->
@*<div class="col-md-4">
        <label class="form-label fw-semibold mb-1">Date Range Picker</label>
        <input class="form-control input-daterange-datepicker" type="text" id="dateRangePicker" name="daterange" autocomplete="off" />
    </div>*@
<!--</div>

<div class="controls-container mb-3">
    <div>
        <span id="selectedCount" class="selected-count"></span>
    </div>
</div>-->

<table class="table table-striped table-bordered" id="table1">
    <thead>
        <tr>
            <th><input type="checkbox" id="selectAllCheckbox" /></th>
            <th>Sr No</th>
            <th>Offer Code</th>
            <th>Offer Name</th>
            <th>Product Code</th>
            <th>Product Name</th>
            <th>Start Date</th>
            <th>End Date</th>
            <th>Discount(%)</th>
            <th>Action</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
            <tr>
                <td><input type="checkbox" class="row-checkbox" /></td>
                <td></td> <!-- Empty cell for serial number -->
                <td>@item.OfferCode</td>
                <td>@item.OfferName</td>
                <td>@item.ProductCode</td>
                <td>@item.ProductName</td>
                <td>@(item.OfferStartDate.HasValue ? item.OfferStartDate.Value.ToString("dd/MM/yyyy") : "")</td>
                <td>@(item.OfferEndDate.HasValue ? item.OfferEndDate.Value.ToString("dd/MM/yyyy") : "")</td>
                <td>@item.OfferDiscountPercentage</td>
                <td>
                    <div class="d-flex gap-2 flex-wrap">

                        <a href="javascript:void(0);"
                           style="font-size: 1.2rem; color: black;"
                           onclick="viewOfferDetails('@item.OfferCode')"
                           title="View Details">
                            <i class="bi bi-eye"></i>
                        </a>

                        <a href="javascript:void(0);"
                           style="font-size: 1.2rem; color: black;"
                           onclick="approveSeller('@item.OfferCode')"
                           title="Approve Seller">
                            <i class="bi bi-check-circle"></i>
                        </a>

                        <a href="javascript:void(0);"
                           style="font-size: 1.2rem; color: black;"
                           onclick="loadSellerRejectForm('@item.OfferCode')"
                           title="Reject Seller">
                            <i class="bi bi-x-circle"></i>
                        </a>

                    </div>
                </td>
            </tr>
        }
    </tbody>
</table>

<!-- Toast Notification -->
<div class="position-fixed end-0 p-3" style="z-index: 11; top: 80px;">
    <div id="liveToast" class="toast align-items-center text-white bg-danger border-0" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="d-flex">
            <div class="toast-body">
                <span id="toastMessage"></span>
            </div>
            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
    </div>
</div>
@*</div>
        </div>
    </section>*@

<!-- Your existing modals -->
<div class="modal fade" id="detailsModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header text-white" style="background: #2C3E50;">
                <h5 class="modal-title">Offer Details</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" id="offerDetailsModalBody"></div>
        </div>
    </div>
</div>


<div class="modal fade" id="rejectModal" tabindex="-1" role="dialog" aria-labelledby="rejectModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header text-white" style="background: #2C3E50;">
                <h5 class="modal-title fs-3">Reject Offer</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" id="rejectModalBody"></div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.4/js/dataTables.bootstrap5.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment@2.29.4/min/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/daterangepicker@3.1/daterangepicker.min.js"></script>

    <!-- SweetAlert2 JS -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <!-- DataTables Buttons -->
    <script src="https://cdn.datatables.net/buttons/2.2.3/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.3/js/buttons.bootstrap5.min.js"></script>

    <!-- Downloaded CDN  -->
    <script src="~/Content/Document/CustomJS/buttons.html5.min.js"></script>
    <script src="~/Content/Document/CustomJS/buttons.print.min.js"></script>
    <script src="~/Content/Document/CustomJS/jszip.min.js"></script>
    <script src="~/Content/Document/CustomJS/pdfmake.min.js"></script>
    <script src="~/Content/Document/CustomJS/vfs_fonts.js"></script>

    <script>
        // Toast notification functions
        function showErrorToast(message) {
            $('#toastMessage').text(message);
            $('#liveToast').removeClass('bg-success').addClass('bg-danger');
            var toastEl = document.getElementById('liveToast');
            var toast = new bootstrap.Toast(toastEl);
            toast.show();
        }

        function showSuccessToast(message) {
            $('#toastMessage').text(message);
            $('#liveToast').removeClass('bg-danger').addClass('bg-success');
            var toastEl = document.getElementById('liveToast');
            var toast = new bootstrap.Toast(toastEl);
            toast.show();
        }

        let table;
        let selectedRows = new Set();

        $(document).ready(function () {
            table = $('#table1').DataTable({
                responsive: true,
                searching: true,
                paging: true,
                ordering: false,
                info: true,
                lengthChange: false,
                pageLength: 10,
                destroy: true,
                autoWidth: false,
                scrollX: false,
                lengthMenu: [5, 10, 25, 50, 100],
                language: {
                    search: "Search:",
                    searchPlaceholder: "Type to search"
                },
                "dom": `
                        <"top d-flex justify-content-between"
                            <"float-start"l>
                            <"d-flex flex-column align-items-end"
                                <"mb-2"B>
                                f
                            >
                        >
                              rt
            <"bottom d-flex justify-content-between"
                i
                <"d-flex justify-content-end"p>
            >
`,
                "buttons": [
                    {
                        extend: 'copy',
                        text: '<img src="/Content/Document/Image/Copy.png" style="width:16px; height:16px;">',
                        attr: { title: 'Copy to clipboard' },
                        //  className: 'buttons-copy',
                        action: function (e, dt, button, config) {
                            if ($('.row-checkbox:checked').length === 0) {
                                showErrorToast('Please select at least one row to export.');
                                return;
                            }
                            $.fn.dataTable.ext.buttons.copyHtml5.action.call(this, e, dt, button, config);
                            //    showSuccessToast('Data copied to clipboard');
                        },
                        exportOptions: {
                            columns: ':not(:first-child, :last-child)', // Exclude first (checkbox) & last (actions)
                            rows: function (idx, data, node) {
                                return $(node).find('.row-checkbox').is(':checked'); // Only selected rows
                            },
                            format: {
                                body: (function () {
                                    let srNoCounter = 0; // Reset counter per export
                                    return function (data, row, column, node) {
                                        if (column === 0) {
                                            srNoCounter++;
                                            return srNoCounter; // Sequential Sr No 1,2,3…
                                        }
                                        return data;
                                    };
                                })()
                            }
                        }
                    },

                    {
                        extend: 'csv',
                        text: '<img src="/Content/Document/Image/CSV.png" style="width:16px; height:16px;">',
                        attr: { title: 'Export as CSV file' },
                        // className: 'buttons-csv',
                        action: function (e, dt, button, config) {
                            if ($('.row-checkbox:checked').length === 0) {
                                showErrorToast('Please select at least one row to export export.');
                                return;
                            }
                            $.fn.dataTable.ext.buttons.csvHtml5.action.call(this, e, dt, button, config);
                            //    showSuccessToast('CSV export started');
                        },
                        filename: 'Offer_List_' + new Date().toISOString().slice(0, 10),
                        exportOptions: {
                            columns: ':not(:first-child, :last-child)', // Exclude checkbox & action columns
                            rows: function (idx, data, node) {
                                return $(node).find('.row-checkbox').is(':checked'); // Only selected rows
                            },
                            format: {
                                body: (function () {
                                    let srNoCounter = 0; // Reset counter per export
                                    return function (data, row, column, node) {
                                        if (column === 0) {
                                            srNoCounter++;
                                            return srNoCounter; // Sequential Sr No 1,2,3…
                                        }
                                        return data;
                                    };
                                })()
                            }
                        }
                    },

                    {
                        extend: 'excel',
                        text: '<img src="/Content/Document/Image/XLS.png" style="width:16px; height:16px;">',
                        attr: { title: 'Export as Excel file' },
                        //className: 'buttons-excel',
                        action: function (e, dt, button, config) {
                            if ($('.row-checkbox:checked').length === 0) {
                                showErrorToast('Please select at least one row to export export.');
                                return;
                            }
                            $.fn.dataTable.ext.buttons.excelHtml5.action.call(this, e, dt, button, config);
                            //    showSuccessToast('Excel export started');
                        },
                        filename: 'Offer_List_' + new Date().toISOString().slice(0, 10),
                        title: 'Offer List',
                        exportOptions: {
                            columns: ':not(:first-child, :last-child)', // Exclude checkbox & action columns
                            rows: function (idx, data, node) {
                                return $(node).find('.row-checkbox').is(':checked'); // Only selected rows
                            },
                            format: {
                                body: (function () {
                                    let srNoCounter = 0; // Reset counter per export
                                    return function (data, row, column, node) {
                                        if (column === 0) {
                                            srNoCounter++;
                                            return srNoCounter; // Sequential Sr No 1,2,3…
                                        }
                                        return data;
                                    };
                                })()
                            }
                        }
                    },

                    {
                        extend: 'pdf',
                        text: '<img src="/Content/Document/Image/PDFicon.png" style="width:16px; height:16px;">',
                        attr: { title: 'Export as PDF' },
                        // className: 'buttons-pdf',
                        action: function (e, dt, button, config) {
                            if ($('.row-checkbox:checked').length === 0) {
                                showErrorToast('Please select at least one row to export.'); return;
                            }
                            $.fn.dataTable.ext.buttons.pdfHtml5.action.call(this, e, dt, button, config);
                        },
                        filename: 'Offer_List_' + new Date().toISOString().slice(0, 10),
                        title: 'Offer List Report',
                        orientation: 'landscape',
                        pageSize: 'A4',
                        exportOptions: {
                            columns: ':not(:first-child, :last-child)',
                            rows: function (idx, data, node) {
                                return $(node).find('.row-checkbox').is(':checked');
                            },
                            format: {
                                body: function (data, row, column, node) {
                                    if (column === 0) {
                                        const checkedRows = $('#table1 tbody tr').filter(function () {
                                            return $(this).find('.row-checkbox').is(':checked');
                                        });
                                        return checkedRows.index(node.parentNode) + 1;
                                    }
                                    return data;
                                }
                            }
                        },
                        customize: function (doc) {
                            // Remove default title
                            doc.content.splice(0, 1);

                            // Get DataTable reference
                            var dt = $('#table1').DataTable();

                            // Generated date + total selected rows
                            let now = new Date();
                            let dateStr = now.getFullYear() + '-' +
                                String(now.getMonth() + 1).padStart(2, '0') + '-' +
                                String(now.getDate()).padStart(2, '0') + ' ' +
                                String(now.getHours()).padStart(2, '0') + ':' +
                                String(now.getMinutes()).padStart(2, '0') + ':' +
                                String(now.getSeconds()).padStart(2, '0');
                            let totalRecords = dt.rows().nodes().to$().find('.row-checkbox:checked').length;

                            // Custom header
                            doc.content.unshift({
                                margin: [0, 0, 0, 12],
                                stack: [
                                    { text: 'Rahishop', fontSize: 16, bold: true, alignment: 'center', margin: [0, 0, 0, 6] },
                                    {
                                        columns: [
                                            { text: 'Offer Management List', fontSize: 12, alignment: 'center', margin: [0, 0, 0, 6] },
                                            {
                                                stack: [
                                                    { text: 'Generated On: ' + dateStr, fontSize: 8, alignment: 'right' },
                                                    { text: 'Total Records: ' + totalRecords, fontSize: 8, alignment: 'right' }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            });

                            // Find table and add serial numbers
                            let tableNode = doc.content.find(node => node.table);
                            if (tableNode) {
                                let serialNumber = 1;
                                tableNode.table.body.forEach(function (row, i) {
                                    if (i > 0) row[0] = serialNumber++;
                                });

                                // Column widths
                                tableNode.table.widths = ['5%', '10%', '15%', '15%', '25%', '10%', '10%', '10%'];

                                // Column alignment and row-specific customization
                                tableNode.table.body.forEach(function (row, rowIndex) {
                                    if (rowIndex === 0) return; // skip header

                                    // Default alignment
                                    row[0] = { text: row[0], alignment: 'center' };
                                    row[1] = { text: row[1], alignment: 'left' };
                                    row[2] = { text: row[2], alignment: 'left' };
                                    row[3] = { text: row[3], alignment: 'left' };
                                    row[4] = { text: row[4], alignment: 'left' };
                                    row[5] = { text: row[5], alignment: 'center' };
                                    row[6] = { text: row[6], alignment: 'center' };
                                    row[7] = { text: row[7], alignment: 'right' };

                                    // Row-specific customization: add image and background color
                                    if (rowIndex === 1 || rowIndex === 3) {
                                        // Example: add image in column 2 (Offer Code)
                                        row[1] = {
                                            stack: [
                                                { text: row[1], alignment: 'left' },
                                                { image: '/Content/Document/Image/sample.png', width: 20, alignment: 'left' } // path to image
                                            ],
                                            fillColor: '#f0f8ff' // light blue background
                                        };

                                        // Change color of the whole row
                                        for (let c = 0; c < row.length; c++) {
                                            if (c !== 1) row[c] = { ...row[c], fillColor: '#f0f8ff' };
                                        }
                                    }
                                });
                            }

                            // Styles (blue header, white text)
                            doc.styles.tableHeader = {
                                fillColor: '#007bff',
                                color: 'white',
                                alignment: 'center',
                                fontSize: 10,
                                bold: true
                            };
                            doc.defaultStyle.fontSize = 8;
                        }

                    },
                    {
                        extend: 'print',
                        text: '<img src="/Content/Document/Image/Print.png" style="width:16px; height:16px;">',
                        attr: { title: 'Print' },
                        //  className: 'buttons-print',
                        action: function (e, dt, button, config) {
                            if ($('.row-checkbox:checked').length === 0) {
                                showErrorToast('Please select at least one row to export.');
                                return;
                            }
                            $.fn.dataTable.ext.buttons.print.action.call(this, e, dt, button, config);
                            //    showSuccessToast('Print dialog opened');
                        },
                        title: 'Offer List',
                        exportOptions: {
                            columns: ':not(:first-child, :last-child)', // Exclude checkbox & action columns
                            rows: function (idx, data, node) {
                                return $(node).find('.row-checkbox').is(':checked'); // Only selected rows
                            },
                            format: {
                                body: (function () {
                                    let srNoCounter = 0; // Reset counter per print
                                    return function (data, row, column, node) {
                                        if (column === 0) {
                                            srNoCounter++;
                                            return srNoCounter; // Sequential Sr No 1,2,3…
                                        }
                                        return data;
                                    };
                                })()
                            }
                        },
                        customize: function (win) {
                            $(win.document.body)
                                .css('font-size', '10pt')
                                .prepend(
                                    '<div style="text-align:center; margin-bottom: 20px;"><h2>Offer List</h2><p>Generated on: ' + new Date().toLocaleDateString() + '</p></div>'
                                );

                            var $table = $(win.document.body).find('table')
                                .addClass('compact')
                                .css('font-size', '9pt');

                            var serial = 1;
                            $table.find('tbody tr').each(function () {
                                if ($(this).find('.row-checkbox').is(':checked')) {
                                    $(this).find('td:nth-child(2)').text(serial++);
                                }
                            });
                        }
                    }
                ],
                "columnDefs": [
                    {
                        "targets": 0, // Checkbox column
                        "orderable": false,
                        "searchable": false
                    },
                    {
                        "targets": 1, // Sr No column
                        "orderable": false,
                        "searchable": false,
                        "render": function (data, type, row, meta) {
                            return meta.row + 1;
                        }
                    },
                    {
                        "targets": 9, // Action column
                        "orderable": false,
                        "searchable": false
                    }
                ]
            });

            // Update serial numbers when filtering/sorting
            table.on('draw.dt', function () {
                table.column(1, { search: 'applied', order: 'applied' }).nodes().each(function (cell, i) {
                    cell.innerHTML = i + 1;
                });
            });

            // Select All checkbox functionality
            $('#selectAllCheckbox').on('change', function () {
                const isChecked = $(this).is(':checked');
                table.$('.row-checkbox').prop('checked', isChecked);

                if (isChecked) {
                    table.rows().every(function () {
                        const node = this.node();
                        selectedRows.add(node);
                    });
                } else {
                    selectedRows.clear();
                }

                updateSelectedCount();
            });

            // Row checkbox functionality
            $(document).on('change', '.row-checkbox', function () {
                const $row = $(this).closest('tr');

                if ($(this).is(':checked')) {
                    selectedRows.add($row[0]);
                } else {
                    selectedRows.delete($row[0]);
                }

                updateSelectAllCheckbox();
                updateSelectedCount();
            });

            // Update Select All checkbox state
            function updateSelectAllCheckbox() {
                const totalRows = table.rows().count();
                const selectedCount = selectedRows.size;

                if (selectedCount === 0) {
                    $('#selectAllCheckbox').prop('indeterminate', false).prop('checked', false);
                } else if (selectedCount === totalRows) {
                    $('#selectAllCheckbox').prop('indeterminate', false).prop('checked', true);
                } else {
                    $('#selectAllCheckbox').prop('indeterminate', true);
                }
            }

            // Make buttons transparent with blue border, radius, and spacing
            function forceTransparentButtons() {
                $('.dt-buttons button, .dt-buttons a').each(function () {
                    $(this).removeClass('btn-secondary btn-primary btn-success btn-info btn-warning btn-danger');

                    this.style.setProperty('background', 'transparent', 'important');
                    this.style.setProperty('background-color', 'transparent', 'important');
                    this.style.setProperty('background-image', 'none', 'important');

                    // 🔵 Blue border
                    this.style.setProperty('border', '1px solid #007bff', 'important');

                    // Keep text black
                    this.style.setProperty('color', '#212529', 'important');

                    // No shadow
                    this.style.setProperty('box-shadow', 'none', 'important');

                    // ➡️ Add spacing between buttons
                    this.style.setProperty('margin-right', '8px', 'important');

                    // 🔄 Rounded corners
                    this.style.setProperty('border-radius', '6px', 'important');
                });
            }


            forceTransparentButtons();
            setTimeout(forceTransparentButtons, 100);
            setTimeout(forceTransparentButtons, 500);
            setTimeout(forceTransparentButtons, 1000);
        });

        function showLoader() { $('#globalLoader').fadeIn(200); }
        function hideLoader() { $('#globalLoader').fadeOut(200); }
        // Your functions with SweetAlert integration
        function viewOfferDetails(offerCode) {
            showLoader();
            $.ajax({
                url: '/Admin/OfferDetailsSC',
                type: 'GET',
                data: { offerCode: offerCode },
                success: function (data) {
                    $('#offerDetailsModalBody').html(data);
                    var modal = new bootstrap.Modal(document.getElementById('detailsModal'));
                    modal.show();
                    hideLoader();
                },
                error: function (xhr) {
                    hideLoader();
                    Swal.fire({
                        icon: 'error',
                        title: 'Error',
                        text: 'Error loading offer details: ' + xhr.responseText,
                        confirmButtonColor: '#3085d6'
                    });
                }
            });
        }

        function approveSeller(OfferCode) {
            Swal.fire({
                title: 'Confirm Approval',
                text: "Are you sure you want to approve this offer?",
                icon: 'question',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Yes, approve it!',
                cancelButtonText: 'Cancel'
            }).then((result) => {
                if (result.isConfirmed) {
                    showLoader();
                    $.ajax({
                        url: '/Admin/ApproveOfferSC',
                        type: 'POST',
                        data: { OfferCode: OfferCode },
                        success: function (response) {
                            hideLoader();
                            if (response.success) {
                                Swal.fire({
                                    icon: 'success',
                                    title: 'Success',
                                    text: response.message,
                                    showConfirmButton: false,
                                    timer: 2000,
                                    timerProgressBar: true
                                }).then(() => {
                                    location.reload();
                                });
                            } else {
                                Swal.fire({
                                    icon: 'error',
                                    title: 'Error',
                                    text: response.message,
                                    showConfirmButton: false,
                                    timer: 2000,
                                    timerProgressBar: true
                                });
                            }
                        },
                        error: function () {
                            hideLoader();
                            Swal.fire({
                                icon: 'error',
                                title: 'Error',
                                text: 'Error occurred while approving the offer.',
                                showConfirmButton: false,
                                timer: 2000,
                                timerProgressBar: true
                            });
                        }
                    });
                }
            });
        }
        function loadSellerRejectForm(OfferCode) {
            showLoader();
            $.get('/Admin/RejectedOfferReasonSC', { OfferCode: OfferCode }, function (data) {
                $('#rejectModalBody').html(data);
                var modal = new bootstrap.Modal(document.getElementById('rejectModal'));
                modal.show();
                hideLoader();
            }).fail(function () {
                hideLoader();
                Swal.fire({
                    icon: 'error',
                    title: 'Error',
                    text: 'Failed to load reject form.',
                    confirmButtonColor: '#3085d6'
                });
            });
        }

        // Update the form submission to use SweetAlert
        $(document).on('submit', '#rejectForm', function (e) {
            e.preventDefault();

            Swal.fire({
                title: 'Confirm Rejection',
                text: "Are you sure you want to reject this offer?",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#d33',
                cancelButtonColor: '#3085d6',
                confirmButtonText: 'Yes, reject it!',
                cancelButtonText: 'Cancel'
            }).then((result) => {
                if (result.isConfirmed) {
                    showLoader();
                    $.ajax({
                        type: "POST",
                        url: "/Admin/RejectOfferInsertSC",
                        data: $(this).serialize(),
                        success: function (res) {
                            hideLoader();
                            if (res.success) {
                                Swal.fire({
                                    icon: 'success',
                                    title: 'Success',
                                    text: 'Offer rejected successfully!',
                                    showConfirmButton: false,
                                    timer: 2000,
                                    timerProgressBar: true
                                }).then(() => {
                                    $("#rejectModal").modal('hide');
                                    location.reload();
                                });
                            } else {
                                Swal.fire({
                                    icon: 'error',
                                    title: 'Error',
                                    text: 'Failed: ' + res.message,
                                    showConfirmButton: false,
                                    timer: 2000,
                                    timerProgressBar: true
                                });
                            }
                        },
                        error: function () {
                            hideLoader();
                            Swal.fire({
                                icon: 'error',
                                title: 'Error',
                                text: 'Internal error occurred.',
                                showConfirmButton: false,
                                timer: 2000,
                                timerProgressBar: true
                            });
                        }
                    });
                }
            });
        });
    </script>
}